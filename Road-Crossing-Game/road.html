<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Road Cross Adventure Enhanced</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: Arial, sans-serif;
      display:flex; justify-content:center; align-items:center;
      min-height:100vh; background:#333;
      overflow:hidden;
    }
    .game-container {
      position:relative; width:800px; height:600px;
      background:#87CEEB; border:3px solid #2F4F4F;
      border-radius:15px; overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
    }
    .game-area {
      position:relative; width:100%; height:100%;
      overflow:hidden;
      transition:background 1s ease;
    }
    .road, .grass {
      position:absolute; width:100%;
    }
    .road {
      height:80px;
      background:#333;
      border-top:3px solid #FFD700;
      border-bottom:3px solid #FFD700;
    }
    .road-lines {
      position:absolute; top:50%; left:0;
      width:100%; height:4px;
      background:repeating-linear-gradient(
        to right, transparent 0px, transparent 20px,
        #FFD700 20px, #FFD700 40px
      );
      transform:translateY(-50%);
    }
    .grass {
      height:60px;
      background:linear-gradient(45deg,#32CD32,#228B22);
      background-image:radial-gradient(circle at 20% 50%,#90EE90 2px,transparent 2px),
                       radial-gradient(circle at 80% 20%,#90EE90 1px,transparent 1px),
                       radial-gradient(circle at 40% 80%,#90EE90 1px,transparent 1px);
    }
    .hud {
      position:absolute; top:10px; left:10px;
      color:white; font-size:18px; font-weight:bold;
      background:rgba(0,0,0,0.7); padding:10px 20px;
      border-radius:10px; z-index:100;
    }
.player {
  position: absolute;
  width: 40px;
  height: 40px;
  border-radius: 50% 50% 0 0;
  transition: all 0.2s ease;
  z-index: 10;
}

.player::before {
  content: '';
  position: absolute;
  top: 5px;
  left: 8px;
  width: 20px;
  height: 15px;
  border-radius: 50%;
}

.player::after {
  content: 'ðŸš¶';
  position: absolute;
  top: -5px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 50px;
  text-shadow: 1px 1px 2px black, 0 0 25px blue, 0 0 5px darkblue;
}

    .player img {
      width:40px; height:60px;
      image-rendering:pixelated;
    }
    .player.walking img {
      animation:walkAnim 0.6s steps(4) infinite;
    }
    @keyframes walkAnim {
      from { background-position:0 0; }
      to { background-position:-160px 0; }
    }
    .vehicle {
      position:absolute; height:50px;
      border-radius:10px;
      transition:left 0.1s linear;
    }
    .car { width:80px; background:linear-gradient(45deg,#FF6B6B,#FF8E53); border:2px solid #E55454; }
    .car::before,.car::after {
      content:''; position:absolute; width:15px; height:15px;
      background:#333; border-radius:50%; bottom:-5px;
    }
    .car::before { left:10px; } .car::after { right:10px; }
    .truck { width:120px; background:linear-gradient(45deg,#4ECDC4,#44A08D); border:2px solid #3A9B95; }
    .truck::before,.truck::after {
      content:''; position:absolute; width:18px; height:18px;
      background:#333; border-radius:50%; bottom:-6px;
    }
    .truck::before { left:15px; } .truck::after { right:15px; }
    .bike { width:50px; background:linear-gradient(45deg,#FFD93D,#F39C12); border:2px solid #E67E22; border-radius:15px; }
    .bike::before,.bike::after {
      content:''; position:absolute; width:12px; height:12px;
      background:#333; border-radius:50%; bottom:-3px;
    }
    .bike::before { left:8px; } .bike::after { right:8px; }

    .game-over, .level-complete {
      position:absolute; top:50%; left:50%;
      transform:translate(-50%,-50%);
      padding:30px; border-radius:15px;
      text-align:center; z-index:1000;
      display:none; color:white;
    }
    .game-over { background:rgba(0,0,0,0.9); }
    .game-over h2 { font-size:2.5em; margin-bottom:20px; color:#FF6B6B; }
    .game-over p { font-size:1.2em; margin-bottom:20px; }
    .restart-btn {
      padding:15px 30px; font-size:18px;
      font-weight:bold; border:none; border-radius:25px;
      cursor:pointer;
      background:linear-gradient(45deg,#FF6B6B,#FF8E53);
      color:white; transition:all 0.3s ease;
      box-shadow:0 4px 15px rgba(0,0,0,0.2);
    }
    .restart-btn:hover {
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(0,0,0,0.3);
    }
    .level-complete {
      background:linear-gradient(45deg,#32CD32,#228B22);
      animation:levelComplete 1s ease-in-out;
    }
    @keyframes levelComplete {
      0% { transform:translate(-50%,-50%) scale(0); }
      50% { transform:translate(-50%,-50%) scale(1.2); }
      100% { transform:translate(-50%,-50%) scale(1); }
    }
    .instructions {
      position:absolute; bottom:10px; left:50%;
      transform:translateX(-50%);
      color:white; font-size:14px;
      background:rgba(0,0,0,0.7); padding:10px 20px;
      border-radius:10px; z-index:100;
    }
    .explosion {
      position:absolute; width:60px; height:60px;
      background:radial-gradient(circle,#FF4444,#FF8800,#FFAA00);
      border-radius:50%; animation:explode 0.5s ease-out;
      z-index:50;
    }
    @keyframes explode {
      0% { transform:scale(0); opacity:1; }
      100% { transform:scale(2); opacity:0; }
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="game-area" id="gameArea">
      <div class="hud">
        Level: <span id="level">1</span> |
        Score: <span id="score">0</span> |
        Lives: <span id="lives">3</span>
      </div>

      <div class="player" id="player"></div>


      <div class="instructions">
        Arrow Keys or WASD = move â€¢ Reach top to levelÂ up!
      </div>
    </div>

    <div class="level-complete" id="levelComplete">
      <h3>Level Complete!</h3>
      <p>Prepare for the next challenge...</p>
    </div>

    <div class="game-over" id="gameOver">
      <h2>Game Over!</h2>
      <p>Final Score: <span id="finalScore">0</span></p>
      <p>You reached Level <span id="finalLevel">1</span></p>
      <button class="restart-btn" onclick="restartGame()">Play Again</button>
    </div>
  </div>

  <script>
    const levels = [
      { bg: 'linear-gradient(135deg,#87CEEB,#98FB98)', spawnRate:2000, speed:1 },
      { bg: 'linear-gradient(135deg,#FFA07A,#FFDAB9)', spawnRate:1800, speed:1.2 },
      { bg: 'linear-gradient(135deg,#483D8B,#708090)', spawnRate:1600, speed:1.5 },
      { bg: 'linear-gradient(135deg,#2F4F4F,#696969)', spawnRate:1400, speed:1.8 },
      { bg: 'linear-gradient(135deg,#000000,#434343)', spawnRate:1200, speed:2.1 }
    ];

    let gameState = {};
    let currentLevel = 0;
    let walkAudioFrame = 0;

    const gameArea = document.getElementById('gameArea');
    const player = document.getElementById('player');
    const playerImg = document.getElementById('playerImg');
    const levelCompleteDiv = document.getElementById('levelComplete');
    const gameOverDiv = document.getElementById('gameOver');
    const finalScoreEl = document.getElementById('finalScore');
    const finalLevelEl = document.getElementById('finalLevel');

    initGame();

    function initGame() {
      currentLevel = 0;
      setupNewGameState();
      initLevel();
      updateHUD();
      gameState.running = true;
      gameLoop();
    }

    function setupNewGameState() {
      gameState = {
        x:380, y:550, level:1, score:0, lives:3,
        vehicles:[], roads:[], running:false,
        spawnRate: levels[0].spawnRate, speed:levels[0].speed
      };
      positionPlayer();
    }

    function initLevel() {
      const lvl = levels[currentLevel];
      gameArea.style.background = lvl.bg;

      gameState.spawnRate = lvl.spawnRate;
      gameState.speed = lvl.speed;

      document.querySelectorAll('.road, .grass').forEach(e=>e.remove());
      gameState.roads = [];

      for (let i=0;i<5;i++){
        const grass = document.createElement('div');
        grass.className = 'grass';
        grass.style.top = `${i*120}px`;
        gameArea.appendChild(grass);

        if(i<4){
          const road = document.createElement('div');
          road.className='road';
          road.style.top = `${i*120+60}px`;
          const lines = document.createElement('div');
          lines.className='road-lines';
          road.appendChild(lines);
          gameArea.appendChild(road);
          gameState.roads.push({y:i*120+60, dir:i%2? -1:1, last:0});
        }
      }
      gameState.x=380; gameState.y=550;
      positionPlayer();
    }

    function positionPlayer(){
      player.style.left = gameState.x+'px';
      player.style.top = gameState.y+'px';
    }

    function updateHUD(){
      document.getElementById('level').textContent = gameState.level;
      document.getElementById('score').textContent = gameState.score;
      document.getElementById('lives').textContent = gameState.lives;
    }

    function createVehicle(idx){
      const r=gameState.roads[idx];
      const types=['car','truck','bike'];
      const type = types[Math.floor(Math.random()*types.length)];
      const el = document.createElement('div');
      el.className=`vehicle ${type}`;
      el.style.top = r.y+15+'px';
      el.style.left = (r.dir===1?'-120px':'820px');
      gameArea.appendChild(el);
      gameState.vehicles.push({
        el,type,x:r.dir===1?-120:820,y:r.y+15,
        dir:r.dir,speed:(2+Math.random()*2)*gameState.speed
      });
    }

    function updateVehicles(){
      const t=Date.now();
      gameState.roads.forEach((r,i)=>{
        if(t-r.last>gameState.spawnRate){
          if(Math.random()<0.7){
            createVehicle(i);
            r.last=t;
          }
        }
      });
      gameState.vehicles = gameState.vehicles.filter(v=>{
        v.x+=v.dir*v.speed; v.el.style.left=v.x+'px';
        if(v.x<-150||v.x>950){
          v.el.remove(); return false;
        }
        return true;
      });
    }

    function checkCollisions(){
      const pr={x:gameState.x,y:gameState.y,w:40,h:60};
      for(const v of gameState.vehicles){
        const w = v.type==='truck'?120: v.type==='car'?80:50;
        const vh=50;
        if(pr.x<v.x+w && pr.x+pr.w>v.x &&
           pr.y<v.y+vh && pr.y+pr.h>v.y){
          hit();
          break;
        }
      }
    }

    function hit(){
      const exp = document.createElement('div');
      exp.className='explosion';
      exp.style.left = gameState.x-10+'px';
      exp.style.top = gameState.y-10+'px';
      gameArea.appendChild(exp);
      setTimeout(()=>exp.remove(),500);

      gameState.lives--;
      updateHUD();
      if(gameState.lives<=0) return endGame();
      gameState.x=380; gameState.y=550; positionPlayer();
    }

    function checkLevelUp(){
      if(gameState.y<=60){
        levelCompleteDiv.style.display='block';
        gameState.running=false;
        setTimeout(()=>{
          levelCompleteDiv.style.display='none';
          currentLevel++;
          if(currentLevel>=levels.length) return endGame(true);
          gameState.level++;
          gameState.score += 100 * gameState.level;
          initLevel(); updateHUD();
          gameState.running=true;
          gameLoop();
        },2000);
      }
    }

    function gameLoop(){
      if(!gameState.running) return;
      updateVehicles();
      checkCollisions();
      updateHUD();
      checkLevelUp();
      requestAnimationFrame(gameLoop);
    }

    function endGame(victory=false){
      gameState.running=false;
      finalScoreEl.textContent = gameState.score;
      finalLevelEl.textContent = gameState.level;
      gameOverDiv.querySelector('h2').textContent = victory ? 'You Win!' : 'Game Over!';
      gameOverDiv.style.display='block';
    }

    function restartGame(){
      gameOverDiv.style.display='none';
      document.querySelectorAll('.vehicle').forEach(e=>e.remove());
      initGame();
    }

    let walking=false;
    document.addEventListener('keydown',e=>{
      if(!gameState.running) return;
      const key=e.key.toLowerCase();
      const step=20;
      let moved=false;
      if(['arrowup','w'].includes(e.key.toLowerCase())){
        if(gameState.y>0){gameState.y-=step;gameState.score++; moved=true;}
      }
      if(['arrowdown','s'].includes(e.key.toLowerCase())){
        if(gameState.y<540){gameState.y+=step; moved=true;}
      }
      if(['arrowleft','a'].includes(e.key.toLowerCase())){
        if(gameState.x>0){gameState.x-=step; moved=true;}
      }
      if(['arrowright','d'].includes(e.key.toLowerCase())){
        if(gameState.x<760){gameState.x+=step; moved=true;}
      }
      if(moved){
        positionPlayer();
        updateHUD();
      }
      if(!walking && moved) setWalking(true);
    });

    document.addEventListener('keyup',e=>{
      if(walking) setWalking(false);
    });

    function setWalking(on){
      walking=on;
      player.classList.toggle('walking',on);
      playerImg.src=on?'walk1.png':'idle1.png';
    }
  </script>
</body>
</html>
